#define current i * (m + 1) + j
#define above (i - 1) * (m + 1) + j
#define left i * (m + 1) + (j-1)
#define diag_left (i - 1) * (m + 1) + (j-1)